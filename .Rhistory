wrap_plots(human = human, cattle, goat, sheep, camels, ncol = 1, guides = "collect")
human <- df_spatial_merged |>
ggplot() +
geom_sf(aes(fill = human_incidence)) +
theme_void() +
scale_fill_gradient(low = "#e5f5e0",
high = "#00441b"
) +
facet_wrap(~year, nrow = 1) +
theme(
plot.title = element_text(color = "black", hjust = 0, vjust = .5)
)
human <- df_spatial_merged |>
ggplot() +
geom_sf(aes(fill = human_incidence)) +
theme_void() +
scale_fill_gradient(low = "#e5f5e0",
high = "#00441b"
) +
facet_wrap(~year, nrow = 1) +
theme(
plot.title = element_text(color = "black", hjust = 0, vjust = .5)
) +
ggtitle("Human")
human
human <- df_spatial_merged |>
ggplot() +
geom_sf(aes(fill = human_incidence)) +
theme_void() +
scale_fill_gradient(low = "#e5f5e0",
high = "#00441b"
) +
facet_wrap(~year, nrow = 1) +
theme(
plot.title = element_text(color = "black", hjust = 0, vjust = 0)
) +
ggtitle("Human")
human
human <- df_spatial_merged |>
ggplot() +
geom_sf(aes(fill = human_incidence)) +
theme_void() +
scale_fill_gradient(low = "#e5f5e0",
high = "#00441b"
) +
facet_wrap(~year, nrow = 1) +
theme(
plot.title = element_text(color = "black", hjust = 0, vjust = 1)
) +
ggtitle("Human")
human
human <- df_spatial_merged |>
ggplot() +
geom_sf(aes(fill = human_incidence)) +
theme_void() +
scale_fill_gradient(low = "#e5f5e0",
high = "#00441b"
) +
facet_wrap(~year, nrow = 1) +
theme(
plot.title = element_text(color = "black", hjust = .5)
) +
ggtitle("Human")
human
cattle <- df_spatial_merged |>
ggplot() +
geom_sf(aes(fill = catt_incidence)) +
theme_void() +
scale_fill_gradient(low = "#e5f5e0",
high = "#00441b"
) +
facet_wrap(~year, nrow = 1) +
theme(
plot.title = element_text(color = "black", hjust = .5)
) +
ggtitle("Cattle")
cattle
cattle <- df_spatial_merged |>
ggplot() +
geom_sf(aes(fill = catt_incidence)) +
theme_void() +
scale_fill_gradient(low = "#e5f5e0",
high = "#00441b"
) +
facet_wrap(~year, nrow = 1) +
theme(
plot.title = element_text(color = "black", hjust = .5)
) +
ggtitle("Cattle")
cattle
goat <- df_spatial_merged |>
ggplot() +
geom_sf(aes(fill = goat_incidence)) +
theme_void() +
scale_fill_gradient(low = "#e5f5e0",
high = "#00441b"
) +
facet_wrap(~year, nrow = 1)
goat <- df_spatial_merged |>
ggplot() +
geom_sf(aes(fill = goat_incidence)) +
theme_void() +
scale_fill_gradient(low = "#e5f5e0",
high = "#00441b"
) +
facet_wrap(~year, nrow = 1) +
theme(
plot.title = element_text(color = "black", hjust = .5)
) +
ggtitle("Goats")
goat
sheep <- df_spatial_merged |>
ggplot() +
geom_sf(aes(fill = shp_incidence)) +
theme_void() +
scale_fill_gradient(low = "#e5f5e0",
high = "#00441b"
) +
facet_wrap(~year, nrow = 1) +
theme(
plot.title = element_text(color = "black", hjust = .5)
) +
ggtitle("Sheep")
sheep
camels <- df_spatial_merged |>
ggplot() +
geom_sf(aes(fill = cam_incidence)) +
theme_void() +
scale_fill_gradient(low = "#e5f5e0",
na.value  = "white",
high = "#00441b"
) +
facet_wrap(~year, nrow = 1) +
theme(
plot.title = element_text(color = "black", hjust = .5)
) +
ggtitle("Sheep")
camels
wrap_plots(human, cattle, goat, sheep, camels, ncol = 1, guides = "collect")
library(ggplot2)
p1 <- ggplot(mtcars) + geom_point(aes(mpg, disp))
p2 <- ggplot(mtcars) + geom_boxplot(aes(gear, disp, group = gear))
# Basic use
p1 + inset_element(p2, 0.6, 0.6, 1, 1)
# Basic use
p1 + inset_element("hey", 0.6, 0.6, 1, 1)
# Basic use
p1 + inset_element(p2, 0, 0.6, 1, 1)
# Basic use
p1 + inset_element(p2, 0, 0, 1, 1)
# Basic use
p1 + inset_element(p2, 0.5, 0.6, 1, 1)
# Align to the full area instead
p1 + inset_element(p2, 0, 0.6, 0.4, 1, align_to = 'full')
logo <- system.file('help', 'figures', 'logo.png', package = 'patchwork')
logo
logo <- png::readPNG(logo, native = TRUE)
logo
p1 + inset_element(logo, 0.8, 0.8, 1, 1, align_to = 'full')
p1 + inset_element(logo, 0.8, 0.8, 1, 1, align_to = 'left')
p1 + inset_element(logo, 0.8, 0.8, 1, 1, align_to = 'panel')
# Just as expected insets are still amenable to changes after the fact
p1 +
inset_element(p2, 0.6, 0.6, 1, 1) +
theme_classic()
# Tagging also continues to work as expected
p1 +
inset_element(p2, 0.6, 0.6, 1, 1) +
plot_annotation(tag_levels = '1')
# but can be turned off, like for wrapped plots
p1 +
inset_element(p2, 0.6, 0.6, 1, 1, ignore_tag = TRUE) +
plot_annotation(tag_levels = '1')
# Tagging also continues to work as expected
p1 +
inset_element( plot_annotation(tag_levels = '1')) +
# but can be turned off, like for wrapped plots
p1 +
inset_element(p2, 0.6, 0.6, 1, 1, ignore_tag = TRUE) +
plot_annotation(tag_levels = '1')
# Tagging also continues to work as expected
p1 +
inset_element( plot_annotation(tag_levels = '1') , 0.6, 0.6, 1, 1) +
# but can be turned off, like for wrapped plots
p1 +
inset_element(p2, 0.6, 0.6, 1, 1, ignore_tag = TRUE) +
plot_annotation(tag_levels = '1')
p1 <- ggplot(mtcars) + geom_point(aes(mpg, disp))
p2 <- ggplot(mtcars) + geom_boxplot(aes(gear, disp, group = gear))
p3 <- ggplot(mtcars) + geom_bar(aes(gear)) + facet_wrap(~cyl)
# Add title, etc. to a patchwork
p1 + p2 + plot_annotation('This is a title', caption = 'made with patchwork')
# Change styling of patchwork elements
p1 + p2 +
plot_annotation(
title = 'This is a title',
caption = 'made with patchwork',
theme = theme(plot.title = element_text(size = 16))
)
# Add tags to plots
p1 / (p2 | p3) +
plot_annotation(tag_levels = 'A')
# Add multilevel tagging to nested layouts
p1 / ((p2 | p3) + plot_layout(tag_level = 'new')) +
plot_annotation(tag_levels = c('A', '1'))
wrap_plots(human, cattle, goat, sheep, camels, ncol = 1, guides = "collect") +
plot_annotation(tag_levels = c('Human', 'Cattle', 'Goat', 'Sheep', 'Camels'))
wrap_plots(human, cattle, goat, sheep, camels, ncol = 1, guides = "collect") +
plot_layout(tag_level = 'new') +
plot_annotation(tag_levels = c('Human', 'Cattle', 'Goat', 'Sheep', 'Camels'))
human/cattle/goat/sheep/camels
human <- df_spatial_merged |>
ggplot() +
geom_sf(aes(fill = human_incidence)) +
theme_void() +
scale_fill_gradient(low = "#e5f5e0",
high = "#00441b"
) +
facet_wrap(~year, nrow = 1) +
theme(
plot.title = element_text(color = "black", hjust = .5)
)
source("C:/Users/WSU/Desktop/kh/analysis.R", echo=TRUE)
# Add multilevel tagging to nested layouts
p1 / ((p2 | p3) + plot_layout(tag_level = 'new')) +
plot_annotation(tag_levels = c('A', '1'))
# Use a custom tag sequence (mixed with a standard one)
p1 / ((p2 | p3) + plot_layout(tag_level = 'new')) +
plot_annotation(tag_levels = list(c('&', '%'), '1'))
# Add multilevel tagging to nested layouts
p1 / ((p2 | p3) + plot_layout(tag_level = 'new')) +
plot_annotation(tag_levels = c('A', '1'))
human/cattle/goat/sheep/camels +
plot_annotation(tag_levels = c('Human', 'Cattle', 'Goat', 'Sheep', 'Camels'))
human/cattle/goat/sheep/camels +
plot_annotation(title = "Specie Incidence")
p1 <- ggplot(iris, aes(x=Species,y=Petal.Length)) + geom_boxplot()
p2 <- ggplot(iris, aes(x=Species,y=Sepal.Length)) + geom_boxplot()
row_label_1 <- wrap_elements(panel = textGrob('First Row', rot=90))
library(grid)
row_label_1 <- wrap_elements(panel = textGrob('First Row', rot=90))
row_label_2 <- wrap_elements(panel = textGrob('First Row', rot=90))
row_label_1
row_label_2
p_all <- (row_label_1 | p1 | p2) / (row_label_2 | p1| p2) +
plot_layout(widths = c(.1,1,1))  # adjust with
p_all
row_label_1 <- wrap_elements(panel = textGrob('Human', rot=90))
row_label_2 <- wrap_elements(panel = textGrob('Cattle', rot=90))
p_all <- (row_label_1 | p1 | p2) / (row_label_2 | p1| p2) +
plot_layout(widths = c(.1,1,1))  # adjust with
p_all
row_label_1 <- wrap_elements(panel = textGrob('Human'))
row_label_2 <- wrap_elements(panel = textGrob('Cattle'))
p_all <- (row_label_1 | p1 | p2) / (row_label_2 | p1| p2) +
plot_layout(widths = c(.1,1,1))  # adjust with
p_all
row_label_1 <- wrap_elements(panel = textGrob('Human'))
row_label_2 <- wrap_elements(panel = textGrob('Cattle'))
row_label_3 <- wrap_elements(panel = textGrob('Goats'))
row_label_4 <- wrap_elements(panel = textGrob('Sheep'))
row_label_5 <- wrap_elements(panel = textGrob('Camels'))
pp = row_label_1/row_label_2/row_label_3/row_label_4/row_label_5
pp
human/cattle/goat/sheep/camels +
pp
(human/ row_label_1) /cattle/goat/sheep/camels +
pp
(human | row_label_1) /cattle/goat/sheep/camels +
pp
(row_label_1| human) / (row_label_2 | cattle) /(row_label_3 | goat)/(row_label_4 | sheep)/ (row_label_5 | camels)
(
row_label_1 |
human
) / (row_label_2 | cattle) /(row_label_3 | goat)/(row_label_4 | sheep)/ (row_label_5 | camels) +
plot_layout(widths = c(.1,1,1))
p_all <- (row_label_1 | p1 | p2) / (row_label_2 | p1| p2) +
plot_layout(widths = c(.9,1,1))  # adjust with
p_all
p_all <- (row_label_1 | p1 | p2) / (row_label_2 | p1| p2) +
plot_layout(widths = c(0,1,1))  # adjust with
p_all
p_all <- (row_label_1 | p1 | p2) / (row_label_2 | p1| p2) +
plot_layout(widths = c(0.4,1,1))  # adjust with
p_all
row_label_1 <- wrap_elements(panel = textGrob('Human', just = "left"))
(
row_label_1 |
human
) / (row_label_2 | cattle) /(row_label_3 | goat)/(row_label_4 | sheep)/ (row_label_5 | camels) +
plot_layout(widths = c(.1, 1, 1))
row_label_1 <- wrap_elements(panel = textGrob('Human', x = unit(0.5, "npc"))
row_label_1 <- wrap_elements(panel = textGrob('Human', x = unit(0.5, "npc")))
row_label_1 <- wrap_elements(panel = textGrob('Human', x = unit(0.5, "npc")))
row_label_1
row_label_1 <- wrap_elements(panel = textGrob('Human', x = unit(0.1, "npc")))
row_label_1
row_label_1 <- wrap_elements(panel = textGrob('Human', x = unit(1, "npc")))
row_label_1
row_label_1 <- wrap_elements(panel = textGrob('Human', x = unit(.6, "npc")))
row_label_1
row_label_1 <- wrap_elements(panel = textGrob('Human', x = unit(.8, "npc")))
row_label_1
(
row_label_1 |
human
) / (row_label_2 | cattle) /(row_label_3 | goat)/(row_label_4 | sheep)/ (row_label_5 | camels) +
plot_layout(widths = c(.1, 1, 1))
row_label_1 <- wrap_elements(panel = textGrob('Human', x = unit(1, "npc")))
(
row_label_1 |
human
) / (row_label_2 | cattle) /(row_label_3 | goat)/(row_label_4 | sheep)/ (row_label_5 | camels) +
plot_layout(widths = c(.1, 1, 1))
row_label_1 <- wrap_elements(panel = textGrob('Human', x = unit(0.9, "npc")))
(
row_label_1 |
human
) / (row_label_2 | cattle) /(row_label_3 | goat)/(row_label_4 | sheep)/ (row_label_5 | camels) +
plot_layout(widths = c(.1, 1, 1))
row_label_1 <- wrap_elements(panel = textGrob('Human', x = unit(0.95, "npc")))
(
row_label_1 |
human
) / (row_label_2 | cattle) /(row_label_3 | goat)/(row_label_4 | sheep)/ (row_label_5 | camels) +
plot_layout(widths = c(.1, 1, 1))
row_label_1 <- wrap_elements(panel = textGrob('Human', x = unit(0.98, "npc")))
(
row_label_1 |
human
) / (row_label_2 | cattle) /(row_label_3 | goat)/(row_label_4 | sheep)/ (row_label_5 | camels) +
plot_layout(widths = c(.1, 1, 1))
row_label_1 <- wrap_elements(panel = textGrob('Human', x = unit(0.97, "npc")))
(
row_label_1 |
human
) / (row_label_2 | cattle) /(row_label_3 | goat)/(row_label_4 | sheep)/ (row_label_5 | camels) +
plot_layout(widths = c(.1, 1, 1))
row_label_1 <- wrap_elements(panel = textGrob('Human', x = unit(0.96, "npc")))
(
row_label_1 |
human
) / (row_label_2 | cattle) /(row_label_3 | goat)/(row_label_4 | sheep)/ (row_label_5 | camels) +
plot_layout(widths = c(.1, 1, 1))
row_label_1 <- wrap_elements(panel = textGrob('Human', x = unit(0.95, "npc")) + theme(element_text(size = 4)))
row_label_1
row_label_1 <- wrap_elements(panel = textGrob('Human', x = unit(0.95, "npc")) + theme(element_text(size = 8)))
row_label_1
row_label_1 <- wrap_elements(panel = textGrob('Human', x = unit(0.95, "npc")) )
row_label_1
row_label_1 <- wrap_elements(panel = textGrob('Human', x = unit(0.95, "npc")) + theme(element_text(size = 8)) )
row_label_1
row_label_1 <- wrap_elements(panel = geom_text('Human', x = unit(0.95, "npc")) + theme(element_text(size = 8)) )
row_label_1 <- wrap_elements(panel = textGrob('Human', x = unit(0.95, "npc")) + theme(element_text(size = 8)) )
row_label_1
row_label_1 <- wrap_elements(panel = textGrob('Human', x = unit(0.95, "npc")))
row_label_2 <- wrap_elements(panel = textGrob('Cattle', x = unit(0.95, "npc")))
row_label_3 <- wrap_elements(panel = textGrob('Goats', x = unit(0.95, "npc")))
row_label_4 <- wrap_elements(panel = textGrob('Sheep', x = unit(0.95, "npc")))
row_label_5 <- wrap_elements(panel = textGrob('Camels', x = unit(0.95, "npc")))
(
row_label_1 |
human
) / (row_label_2 | cattle) /(row_label_3 | goat)/(row_label_4 | sheep)/ (row_label_5 | camels) +
plot_layout(widths = c(.1, 1, 1))
row_label_1 <- wrap_elements(panel = textGrob('Human', x = unit(0.95, "npc")), size = 8)
library(ggplot2)
library(patchwork)
# Convert year to factor for better plotting
df_spatial_merged$year <- as.factor(df_spatial_merged$year)
# Function to create individual plots
create_species_plot <- function(data, species) {
ggplot(data) +
geom_sf(aes(fill = !!sym(paste0(species, "_incidence")))) +
theme_void() +
scale_fill_gradient(low = "#e5f5e0", high = "#00441b") +
facet_wrap(~year, nrow = 1) +
ggtitle(species)
}
# Create individual plots
human <- create_species_plot(df_spatial_merged, "human")
cattle <- create_species_plot(df_spatial_merged, "catt")
goat <- create_species_plot(df_spatial_merged, "goat")
sheep <- create_species_plot(df_spatial_merged, "shp")
camels <- create_species_plot(df_spatial_merged, "cam")
# Create labels
row_label_1 <- wrap_elements(panel = textGrob('Human', x = unit(0.01, "npc")))
row_label_2 <- wrap_elements(panel = textGrob('Cattle', x = unit(0.01, "npc")))
row_label_3 <- wrap_elements(panel = textGrob('Goats', x = unit(0.01, "npc")))
row_label_4 <- wrap_elements(panel = textGrob('Sheep', x = unit(0.01, "npc")))
row_label_5 <- wrap_elements(panel = textGrob('Camels', x = unit(0.01, "npc")))
# Combine plots using patchwork and adjust layout
combined_plots <- wrap_plots(human, cattle, goat, sheep, camels, ncol = 1, guides = "collect") +
plot_layout(widths = c(0.1, 1, 1))
# Add labels
combined_plots + row_label_1 | combined_plots + row_label_2 | combined_plots + row_label_3 | combined_plots + row_label_4 | combined_plots + row_label_5
(
row_label_1 |
human
) / (row_label_2 | cattle) /(row_label_3 | goat)/(row_label_4 | sheep)/ (row_label_5 | camels)
(
row_label_1 |
human
) / (row_label_2 | cattle) /(row_label_3 | goat)/(row_label_4 | sheep)/ (row_label_5 | camels) +
plot_layout(widths = c(.1, 1, 1))
human <- df_spatial_merged |>
ggplot() +
geom_sf(aes(fill = human_incidence)) +
theme_void() +
scale_fill_gradient(low = "#e5f5e0",
high = "#00441b"
) +
facet_wrap(~year, nrow = 1) +
theme(
plot.title = element_text(color = "black", hjust = .5)
)
#ggtitle("Human")
human
cattle <- df_spatial_merged |>
ggplot() +
geom_sf(aes(fill = catt_incidence)) +
theme_void() +
scale_fill_gradient(low = "#e5f5e0",
high = "#00441b"
) +
facet_wrap(~year, nrow = 1) +
theme(
plot.title = element_text(color = "black", hjust = .5)
)
#ggtitle("Cattle")
cattle
goat <- df_spatial_merged |>
ggplot() +
geom_sf(aes(fill = goat_incidence)) +
theme_void() +
scale_fill_gradient(low = "#e5f5e0",
high = "#00441b"
) +
facet_wrap(~year, nrow = 1) +
theme(
plot.title = element_text(color = "black", hjust = .5)
)
#ggtitle("Goats")
goat
sheep <- df_spatial_merged |>
ggplot() +
geom_sf(aes(fill = shp_incidence)) +
theme_void() +
scale_fill_gradient(low = "#e5f5e0",
high = "#00441b"
) +
facet_wrap(~year, nrow = 1) +
theme(
plot.title = element_text(color = "black", hjust = .5)
)
#ggtitle("Sheep")
sheep
camels <- df_spatial_merged |>
ggplot() +
geom_sf(aes(fill = cam_incidence)) +
theme_void() +
scale_fill_gradient(low = "#e5f5e0",
na.value  = "white",
high = "#00441b"
) +
facet_wrap(~year, nrow = 1) +
theme(
plot.title = element_text(color = "black", hjust = .5)
)
#ggtitle("Sheep")
camels
# library(patchwork)
#
# # Assuming df_spatial_merged is your data
#
# # Convert year to factor for better plotting
# df_spatial_merged$year <- as.factor(df_spatial_merged$year)
#
# # Function to create individual plots
# create_species_plot <- function(data, species) {
#   ggplot(data) +
#     geom_sf(aes(fill = !!sym(paste0(species, "_incidence")))) +
#     theme_void() +
#     scale_fill_gradient(low = "#e5f5e0", high = "#00441b") +
#     facet_wrap(~year, nrow = 1) +
#     ggtitle(species)
# }
#
# # Create individual plots
# human <- create_species_plot(df_spatial_merged, "human")
# cattle <- create_species_plot(df_spatial_merged, "catt")
# goat <- create_species_plot(df_spatial_merged, "goat")
# sheep <- create_species_plot(df_spatial_merged, "shp")
# camels <- create_species_plot(df_spatial_merged, "cam")
# library(patchwork)
#
# # Combine plots using patchwork
# combined_plots <- human / cattle / goat / sheep / camels
#
# # Display the combined plots
# combined_plots
wrap_plots(human, cattle, goat, sheep, camels, ncol = 1, guides = "collect")
row_label_1 <- wrap_elements(panel = textGrob('Human', x = unit(0.95, "npc")))
row_label_2 <- wrap_elements(panel = textGrob('Cattle', x = unit(0.95, "npc")))
row_label_3 <- wrap_elements(panel = textGrob('Goats', x = unit(0.95, "npc")))
row_label_4 <- wrap_elements(panel = textGrob('Sheep', x = unit(0.95, "npc")))
row_label_5 <- wrap_elements(panel = textGrob('Camels', x = unit(0.95, "npc")))
(
row_label_1 |
human
) / (row_label_2 | cattle) /(row_label_3 | goat)/(row_label_4 | sheep)/ (row_label_5 | camels) +
plot_layout(widths = c(.1, 1, 1))
