lab_size = 3) +
theme_light() +
labs(subtitle = "Correlation between\nhuman incidence \nand animal incidences",
x = NULL,
y = NULL) +
guides(fill = "none") +
theme(
strip.background = element_rect(fill = "white", colour = "grey"),
strip.text = element_text(color = "black", size = 12),
axis.title = element_text(colour = "black"),
axis.text = element_text(color = "black"),
axis.ticks = element_line(color = "black", linewidth = 1),
plot.title = element_text(
color = "black",
hjust = 0.5,
size = 16
),
text = element_text(color = "black", size = 14)
axis.title.y = element_text(color = "black", size = 10),
# Correlation Plot
cor_lag <- df_diff %>%
as_tibble() %>%
select(-date) %>%
setNames(c("Human",
"Cattle",
"Camel",
"Goat",
"Sheep")) |>
cor() %>%
ggcorrplot::ggcorrplot(type = "upper",
lab = TRUE,
lab_size = 3) +
theme_light() +
labs(subtitle = "Correlation between\nhuman incidence \nand animal incidences",
x = NULL,
y = NULL) +
guides(fill = "none") +
theme(
strip.background = element_rect(fill = "white", colour = "grey"),
strip.text = element_text(color = "black", size = 12),
axis.title = element_text(colour = "black"),
axis.text = element_text(color = "black"),
axis.ticks = element_line(color = "black", linewidth = 1),
plot.title = element_text(
color = "black",
hjust = 0.5,
size = 16
),
text = element_text(color = "black", size = 14),
axis.title.y = element_text(color = "black", size = 10),
legend.position = "right",
legend.text = element_text(color = "black")
)
cor_lag
# Correlation Plot
cor_lag <- df_diff %>%
as_tibble() %>%
select(-date) %>%
setNames(c("Human",
"Cattle",
"Camel",
"Goat",
"Sheep")) |>
cor() %>%
ggcorrplot::ggcorrplot(type = "upper",
lab = TRUE,
lab_size = 3) +
theme_light() +
labs(subtitle = "Correlation between\nhuman incidence \nand animal incidences",
x = NULL,
y = NULL) +
guides(fill = "none") +
theme(
strip.background = element_rect(fill = "white", colour = "grey"),
strip.text = element_text(color = "black", size = 12),
axis.title = element_text(colour = "black"),
axis.text = element_text(color = "black"),
axis.ticks = element_line(color = "black", linewidth = 1),
plot.title = element_text(
color = "black",
hjust = 0.5,
size = 16
),
text = element_text(color = "black", size = 14),
axis.title.y = element_text(color = "black", size = 2),
legend.position = "right",
legend.text = element_text(color = "black")
)
cor_lag
# Correlation Plot
cor_lag <- df_diff %>%
as_tibble() %>%
select(-date) %>%
setNames(c("Human",
"Cattle",
"Camel",
"Goat",
"Sheep")) |>
cor() %>%
ggcorrplot::ggcorrplot(type = "upper",
lab = TRUE,
lab_size = 3) +
theme_light() +
labs(subtitle = "Correlation between\nhuman incidence \nand animal incidences",
x = NULL,
y = NULL) +
guides(fill = "none") +
theme(
strip.background = element_rect(fill = "white", colour = "grey"),
strip.text = element_text(color = "black", size = 12),
axis.title = element_text(colour = "black"),
axis.text = element_text(color = "black"),
axis.ticks = element_line(color = "black", linewidth = 1),
plot.title = element_text(
color = "black",
hjust = 0.5,
size = 16
),
text = element_text(color = "black", size = 14),
axis.title.y = element_text(color = "black", size = 20),
legend.position = "right",
legend.text = element_text(color = "black")
)
cor_lag
# Correlation Plot
cor_lag <- df_diff %>%
as_tibble() %>%
select(-date) %>%
setNames(c("Human",
"Cattle",
"Camel",
"Goat",
"Sheep")) |>
cor() %>%
ggcorrplot::ggcorrplot(type = "upper",
lab = TRUE,
lab_size = 3) +
theme_light() +
labs(subtitle = "Correlation between\nhuman incidence \nand animal incidences",
x = NULL,
y = NULL) +
guides(fill = "none") +
theme(
strip.background = element_rect(fill = "white", colour = "grey"),
strip.text = element_text(color = "black", size = 12),
axis.title = element_text(colour = "black"),
axis.text = element_text(color = "black"),
axis.ticks = element_line(color = "black", linewidth = 1),
plot.title = element_text(
color = "black",
hjust = 0.5,
size = 16
),
text = element_text(color = "black", size = 2),
axis.title.y = element_text(color = "black", size = 10),
legend.position = "right",
legend.text = element_text(color = "black")
)
cor_lag
# Correlation Plot
cor_lag <- df_diff %>%
as_tibble() %>%
select(-date) %>%
setNames(c("Human",
"Cattle",
"Camel",
"Goat",
"Sheep")) |>
cor() %>%
ggcorrplot::ggcorrplot(type = "upper",
lab = TRUE,
lab_size = 6) +
theme_light() +
labs(subtitle = "Correlation between\nhuman incidence \nand animal incidences",
x = NULL,
y = NULL) +
guides(fill = "none") +
theme(
strip.background = element_rect(fill = "white", colour = "grey"),
strip.text = element_text(color = "black", size = 12),
axis.title = element_text(colour = "black"),
axis.text = element_text(color = "black"),
axis.ticks = element_line(color = "black", linewidth = 1),
plot.title = element_text(
color = "black",
hjust = 0.5,
size = 16
),
axis.title.y = element_text(color = "black", size = 10),
legend.position = "right",
legend.text = element_text(color = "black")
)
cor_lag
# Correlation Plot
cor_lag <- df_diff %>%
as_tibble() %>%
select(-date) %>%
setNames(c("Human",
"Cattle",
"Camel",
"Goat",
"Sheep")) |>
cor() %>%
ggcorrplot::ggcorrplot(type = "upper",
lab = TRUE,
lab_size = 5) +
theme_light() +
labs(subtitle = "Correlation between\nhuman incidence \nand animal incidences",
x = NULL,
y = NULL) +
guides(fill = "none") +
theme(
strip.background = element_rect(fill = "white", colour = "grey"),
strip.text = element_text(color = "black", size = 12),
axis.title = element_text(colour = "black"),
axis.text = element_text(color = "black"),
axis.ticks = element_line(color = "black", linewidth = 1),
plot.title = element_text(
color = "black",
hjust = 0.5,
size = 16
),
axis.title.y = element_text(color = "black", size = 10),
legend.position = "right",
legend.text = element_text(color = "black")
)
cor_lag
# Correlation Plot at lag 1
cor_lag1 <- df_diff %>%
as_tibble() %>%
mutate_at(vars(catt_incidence, cam_incidence, goat_incidence, shp_incidence),
list( ~ lag(., n = 1))) |>
na.omit() |>
select(-date) %>%
setNames(c("Human",
"Cattle",
"Camel",
"Goat",
"Sheep")) |>
cor() %>%
ggcorrplot::ggcorrplot(type = "upper",
lab = TRUE,
lab_size = 5) +
theme_light() +
labs(subtitle = "Correlation between\nhuman incidence \nand animal incidences at lag 1",
x = NULL,
y = NULL) +
guides(fill = "none") +
theme(
strip.background = element_rect(fill = "white", colour = "grey"),
strip.text = element_text(color = "black", size = 12),
axis.title = element_text(colour = "black"),
axis.text = element_text(color = "black"),
axis.ticks = element_line(color = "black", linewidth = 1),
plot.title = element_text(
color = "black",
hjust = 0.5,
size = 16
),
axis.title.y = element_text(color = "black", size = 10),
legend.position = "right",
legend.text = element_text(color = "black")
)
cor_lag1
# Correlation Plot at lag 2
cor_lag2 <- df_diff %>%
as_tibble() %>%
mutate_at(vars(catt_incidence, cam_incidence, goat_incidence, shp_incidence),
list( ~ lag(., n = 2))) |>
na.omit() |>
select(-date) %>%
setNames(c("Human",
"Cattle",
"Camel",
"Goat",
"Sheep")) |>
cor() %>%
ggcorrplot::ggcorrplot(type = "upper",
lab = TRUE,
lab_size = 5) +
theme_light() +
labs(subtitle = "Correlation between\nhuman incidence \nand animal incidences at lag 2",
x = NULL,
y = NULL) +
guides(fill = "none") +
theme(
strip.background = element_rect(fill = "white", colour = "grey"),
strip.text = element_text(color = "black", size = 12),
axis.title = element_text(colour = "black"),
axis.text = element_text(color = "black"),
axis.ticks = element_line(color = "black", linewidth = 1),
plot.title = element_text(
color = "black",
hjust = 0.5,
size = 12
),
axis.title.y = element_text(color = "black", size = 10),
legend.position = "right",
legend.text = element_text(color = "black")
)
# Correlation Plot at lag 2
cor_lag2 <- df_diff %>%
as_tibble() %>%
mutate_at(vars(catt_incidence, cam_incidence, goat_incidence, shp_incidence),
list( ~ lag(., n = 2))) |>
na.omit() |>
select(-date) %>%
setNames(c("Human",
"Cattle",
"Camel",
"Goat",
"Sheep")) |>
cor() %>%
ggcorrplot::ggcorrplot(type = "upper",
lab = TRUE,
lab_size = 5) +
theme_light() +
labs(subtitle = "Correlation between\nhuman incidence \nand animal incidences at lag 2",
x = NULL,
y = NULL) +
guides(fill = "none") +
theme(
strip.background = element_rect(fill = "white", colour = "grey"),
strip.text = element_text(color = "black", size = 12),
axis.title = element_text(colour = "black"),
axis.text = element_text(color = "black"),
axis.ticks = element_line(color = "black", linewidth = 1),
plot.title = element_text(
color = "black",
hjust = 0.5,
size = 16
),
axis.title.y = element_text(color = "black", size = 10),
legend.position = "right",
legend.text = element_text(color = "black")
)
cor_lag2
# Correlation Plot at lag 3
cor_lag3 <- df_diff %>%
as_tibble() %>%
mutate_at(vars(catt_incidence, cam_incidence, goat_incidence, shp_incidence),
list( ~ lag(., n = 3))) |>
na.omit() |>
select(-date) %>%
setNames(c("Human",
"Cattle",
"Camel",
"Goat",
"Sheep")) |>
cor() %>%
ggcorrplot::ggcorrplot(type = "upper",
lab = TRUE,
lab_size = 5) +
theme_light() +
labs(subtitle = "Correlation between\nhuman incidence \nand animal incidences at lag 3",
x = NULL,
y = NULL) +
guides(fill = "none") +
theme(
strip.background = element_rect(fill = "white", colour = "grey"),
strip.text = element_text(color = "black", size = 12),
axis.title = element_text(colour = "black"),
axis.text = element_text(color = "black"),
axis.ticks = element_line(color = "black", linewidth = 1),
plot.title = element_text(
color = "black",
hjust = 0.5,
size = 12
),
axis.title.y = element_text(color = "black", size = 10),
legend.position = "right",
legend.text = element_text(color = "black")
)
# Correlation Plot at lag 3
cor_lag3 <- df_diff %>%
as_tibble() %>%
mutate_at(vars(catt_incidence, cam_incidence, goat_incidence, shp_incidence),
list( ~ lag(., n = 3))) |>
na.omit() |>
select(-date) %>%
setNames(c("Human",
"Cattle",
"Camel",
"Goat",
"Sheep")) |>
cor() %>%
ggcorrplot::ggcorrplot(type = "upper",
lab = TRUE,
lab_size = 5) +
theme_light() +
labs(subtitle = "Correlation between\nhuman incidence \nand animal incidences at lag 3",
x = NULL,
y = NULL) +
guides(fill = "none") +
theme(
strip.background = element_rect(fill = "white", colour = "grey"),
strip.text = element_text(color = "black", size = 12),
axis.title = element_text(colour = "black"),
axis.text = element_text(color = "black"),
axis.ticks = element_line(color = "black", linewidth = 1),
plot.title = element_text(
color = "black",
hjust = 0.5,
size = 16
),
axis.title.y = element_text(color = "black", size = 10),
legend.position = "right",
legend.text = element_text(color = "black")
)
# Correlation Plot at lag 4
cor_lag4 <- df_diff %>%
as_tibble() %>%
mutate_at(vars(catt_incidence, cam_incidence, goat_incidence, shp_incidence),
list( ~ lag(., n = 4))) |>
na.omit() |>
select(-date) %>%
setNames(c("Human",
"Cattle",
"Camel",
"Goat",
"Sheep")) |>
cor() %>%
ggcorrplot::ggcorrplot(type = "upper",
lab = TRUE,
lab_size = 5) +
theme_light() +
labs(subtitle = "Correlation between\nhuman incidence \nand animal incidences at lag 4",
x = NULL,
y = NULL) +
guides(fill = "none") +
theme(
strip.background = element_rect(fill = "white", colour = "grey"),
strip.text = element_text(color = "black", size = 12),
axis.title = element_text(colour = "black"),
axis.text = element_text(color = "black"),
axis.ticks = element_line(color = "black", linewidth = 1),
plot.title = element_text(
color = "black",
hjust = 0.5,
size = 16
),
axis.title.y = element_text(color = "black", size = 10),
legend.position = "right",
legend.text = element_text(color = "black")
)
all_cols <- all_cols + theme(plot.title = element_text(size = 16))
all_cols
knitr::opts_chunk$set(echo = F, message = F, warning = F)
options(scipen=1, digits=3)
source("TSLM.R")
goat_mod_results |> kableExtra::kable(format = "pipe")
all_cols <- all_cols + theme(plot.title = element_text(size = 16),
axis.text.y = element_text(color = 'black', size = 13)
)
all_cols
all_cols <- wrap_plots(
cor_lag,
cor_lag1,
cor_lag2,
cor_lag3,
cor_lag4,
cor_lag5,
cor_lag6,
ncol = 3,
guides = "collect"
) |>
plot_grid(
rel_widths = c(7, 7,7)  # Adjust the values to control relative widths
)
all_cols <- all_cols + theme(plot.title = element_text(size = 16),
axis.text.y = element_text(color = 'black', size = 13)
)
all_cols
all_cols <- wrap_plots(
cor_lag,
cor_lag1,
cor_lag2,
cor_lag3,
cor_lag4,
cor_lag5,
cor_lag6,
ncol = 3,
guides = "collect"
) |>
plot_grid(
rel_widths = c(7, 7,7),
ncol = 3,
labels = "AUTO"
)
all_cols <- all_cols + theme(plot.title = element_text(size = 16),
axis.text.y = element_text(color = 'black', size = 13)
)
all_cols
all_cols <- wrap_plots(
cor_lag,
cor_lag1,
cor_lag2,
cor_lag3,
cor_lag4,
cor_lag5,
cor_lag6,
ncol = 3,
guides = "collect"
) |>
plot_grid(
rel_widths = c(7, 7,7),
labels = "AUTO"
)
all_cols <- all_cols + theme(plot.title = element_text(size = 16),
axis.text.y = element_text(color = 'black', size = 13)
)
all_cols
